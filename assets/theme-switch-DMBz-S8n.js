class n{constructor(t,e={}){this.element=t,this.options={defaultTheme:null,onChange:null,storageKey:"pm7-theme",applyToRoot:!0,...e},this.button=null,this.currentTheme=null,this.init()}init(){this.element.classList.contains("pm7-theme-switch")||this.element.classList.add("pm7-theme-switch"),this.button=this.element.querySelector(".pm7-theme-switch-button"),this.button||this.createButton(),this.currentTheme=this.getInitialTheme(),this.updateTheme(this.currentTheme,!1),this.button.addEventListener("click",()=>this.toggle()),this.button.addEventListener("keydown",t=>{(t.key==="Enter"||t.key===" ")&&(t.preventDefault(),this.toggle())}),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{localStorage.getItem(this.options.storageKey)||this.updateTheme(e.matches?"dark":"light")})}createButton(){this.button=document.createElement("button"),this.button.className="pm7-theme-switch-button",this.button.setAttribute("type","button"),this.button.setAttribute("role","switch"),this.button.setAttribute("aria-label","Toggle theme");const t=document.createElement("div");t.className="pm7-theme-switch-thumb";const e=document.createElementNS("http://www.w3.org/2000/svg","svg");e.setAttribute("class","pm7-theme-switch-icon pm7-theme-switch-sun"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.setAttribute("stroke","currentColor"),e.setAttribute("stroke-width","2"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-linejoin","round"),e.innerHTML=`
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    `;const i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("class","pm7-theme-switch-icon pm7-theme-switch-moon"),i.setAttribute("viewBox","0 0 24 24"),i.setAttribute("fill","none"),i.setAttribute("stroke","currentColor"),i.setAttribute("stroke-width","2"),i.setAttribute("stroke-linecap","round"),i.setAttribute("stroke-linejoin","round"),i.innerHTML='<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>',t.appendChild(e),t.appendChild(i),this.button.appendChild(t),this.element.appendChild(this.button)}getInitialTheme(){if(this.options.defaultTheme)return this.options.defaultTheme;const t=localStorage.getItem(this.options.storageKey);return t==="light"||t==="dark"?t:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}toggle(){const t=this.currentTheme==="light"?"dark":"light";this.updateTheme(t)}updateTheme(t,e=!0){this.currentTheme=t,this.element.setAttribute("data-theme",t),this.button.setAttribute("aria-checked",t==="dark"?"true":"false"),this.button.setAttribute("aria-label",`Switch to ${t==="light"?"dark":"light"} mode`),this.options.applyToRoot&&(document.documentElement.classList.toggle("dark",t==="dark"),document.body.classList.toggle("dark",t==="dark")),e&&localStorage.setItem(this.options.storageKey,t),this.options.onChange&&e&&this.options.onChange(t)}setTheme(t){(t==="light"||t==="dark")&&this.updateTheme(t)}getTheme(){return this.currentTheme}static autoInit(){document.querySelectorAll("[data-pm7-theme-switch]").forEach(e=>{const i=e.getAttribute("data-default-theme"),s=e.getAttribute("data-storage-key")||"pm7-theme",o=e.getAttribute("data-apply-to-root")!=="false";new n(e,{defaultTheme:i,storageKey:s,applyToRoot:o})})}}typeof document<"u"&&document.addEventListener("DOMContentLoaded",()=>{n.autoInit()});export{n as P};
